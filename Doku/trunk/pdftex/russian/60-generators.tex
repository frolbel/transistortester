\chapter{Генератор сигналов}

Режимы генерации различных сигналов доступны только для ATmega328.
Итак, Вы должны включить меню дополнительных функций опцией WITH\_MENU в Makefile.
Меню дополнительных функций вызывается продолжительным (>~\(300~ms\)) нажатием на кнопку 
{\bf TEST}. Функции дополнительного меню отображаются во второй строке дисплея. Вы можете 
выбрать отображаемую функцию длительным нажатием кнопки {\bf TEST}. 
Следующая функция дополнительного меню отображается автоматически через 5 секунд автоматически 
или после короткого нажатия кнопки {\bf TEST}.

\label{sec:generation}
\section{Генератор частоты}
Генератор частоты запускается, если Вы выбрали «f-Generator» (Генератор частоты) длительным 
нажатием кнопки {\bf TEST} из меню дополнительных функций.  
Сигнал частоты выводится через резистор \(680~\Omega\) на тестовый контакт TP2.
Тестовый контакт TP1 программно подключается к GND.

Частоты создаются при помощи 16-разрядного счетчика из тактовой частоты CPU (\(8~MHz\) или \(16~MHz\)).
Задать значение генерируемой частоты можно для каждого разряда, начиная с разряда единиц \(1~Hz\) от 0 до 9.
Для самого высокого разряда \(100~kHz\) значение изменяется от 0 до 20.
Таким образом, можно задать значение частоты до \(2~MHz\).
Без энкодера значение цифры разряда может быть только увеличено при коротком (\textless~0.8~s) нажатии клавиши.
С помощью поворотного энкодера Вы можете изменить значение цифры разряда в любом направлении.
Более длительное нажатие клавиши позволяет выбирать старший разряд для задания цифры генерируемой частоты.
Дополнительный символ в первой позиции отображает направление изменения цифры в разряде.
Символ \textgreater~показывает, что будет выбрано следующее, более высокое значение.
Символ \textless~означает, что будет выбрано более низкое значение (вплоть до \(1~Hz\)).
Если выбран самый высокий разряд \(100~kHz\), то символ \textgreater~заменяется символом R.
В этом состоянии более длительное нажатие сбрасывает значение частоты к исходному значению \(1~Hz\).
Поскольку не каждая из выбранных частот может быть корректно сгенерирована,
разница заданного значения с генерируемой частотой отображается в строке 3 или за значением частоты.
Если удерживать клавишу нажатой в течение длительного (\textgreater~2~s) времени, Вы можете вернуться 
в диалоговое окно функции для выбора
других дополнительных функций.

\section{Широтно-импульсный генератор}
Широтно-импульсный генератор запускается, если Вы выбрали функцию «10-Bit PWM» (16-битный ШИМ)
длительным нажатием кнопки {\bf TEST} из меню дополнительных функций.
Частота через резистор \(680~\Omega\) выводится на тестовый контакт TP2.
Тестовый контакт TP1 программно подключается к GND.
Частота выходного сигнала всегда равна частоте CPU разделенной на 1024.
Для CPU с тактовой частотой \(8~MHz\) частота выходного сигнала составляет \(7812,5~Hz\).
При нажатии кнопки {\bf TEST}, возможно изменение ширины только положительного импульса.
При кратковременном нажатии кнопки {\bf TEST}, Вы можете увеличивать ширину импульса до 
\(99~\%\) с шагом \(1~\%\). При более длительном удержании кнопки, изменение ширины 
импульса происходит с шагом 10~\%.   
Если значение ширины импульса достигает \(99~\%\), то из результата вычитается 100.
При значении ширины импульса \(0~\%\) генерируется положительный импульс самой малой ширины.
